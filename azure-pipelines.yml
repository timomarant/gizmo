# Node.js
# Build a general Node.js project with npm.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

resources:
  repositories:
  - repository: gizmo
    type: github
    endpoint: 'GitHub connection 1'
    name: timomarant/gizmo
  - repository: Gizmo.App
    type: git
    name: Gizmo/Gizmo.App

trigger:
- master

name: 'ubuntu-latest'

steps:
- checkout: gizmo
- checkout: Gizmo.App

- task: NodeTool@0
  displayName: 'Node available on machine'
  inputs:
    versionSpec: 12.x
    checkLatest: true

- task: Npm@1
  displayName: 'Install -g @angular/cli'
  inputs:
    command: custom
    verbose: false
    customCommand: 'install -g @angular/cli'

- task: Npm@1
  displayName: 'Install npm'
  inputs:
    verbose: false

- task: Npm@1
  displayName: 'Install -D electron@latest'
  inputs:
    command: custom
    verbose: false
    customCommand: 'install -D electron@latest'

- task: Npm@1
  displayName: 'Run builder-publish-to-github'
  inputs:
    command: custom
    verbose: false
    customCommand: 'run builder-publish-to-github'

- task: GitHubRelease@1
  displayName: 'GitHub release (create)'
  inputs:
    gitHubConnection: 'GitHub connection 1'
